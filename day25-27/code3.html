<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <select id="year-select">
        <option value="2000">2000</option>
        <option value="2001">2001</option>
        <option value="2020">2020</option>
        <option value="2032">2032</option>
    </select>

    <select id="month-select">
        <option value="1">01</option>
        <option value="2">02</option>
        <option value="3">03</option>
        <option value="4">04</option>
        <option value="5">05</option>
        <option value="6">06</option>
        <option value="7">07</option>
        <option value="8">08</option>
        <option value="9">09</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
    </select>
    <select id="day-select">
        <option value="01">01</option>
        <option value="02">02</option>
        <option value="03">03</option>
        <option value="04">04</option>
        <option value="05">05</option>
        <option value="06">06</option>
        <option value="07">07</option>
        <option value="08">08</option>
        <option value="09">09</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
    </select>

    <select id="hour-select">
        <option value="0">00</option>
        <option value="1">01</option>
        <option value="2">02</option>
        <option value="3">03</option>
        <option value="4">04</option>
        <option value="5">05</option>
        <option value="6">06</option>
        <option value="7">07</option>
        <option value="8">08</option>
        <option value="9">09</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        <option value="37">37</option>
        <option value="38">38</option>
        <option value="39">39</option>
        <option value="40">40</option>
        <option value="41">41</option>
        <option value="42">42</option>
        <option value="43">43</option>
        <option value="44">44</option>
        <option value="45">45</option>
        <option value="46">46</option>
        <option value="47">47</option>
        <option value="48">48</option>
        <option value="49">49</option>
        <option value="50">50</option>
        <option value="51">51</option>
        <option value="52">52</option>
        <option value="53">53</option>
        <option value="54">54</option>
        <option value="55">55</option>
        <option value="56">56</option>
        <option value="57">57</option>
        <option value="58">58</option>
        <option value="59">59</option>
    </select>

    <select id="minite-select">
        <option value="0">00</option>
        <option value="1">01</option>
        <option value="2">02</option>
        <option value="3">03</option>
        <option value="4">04</option>
        <option value="5">05</option>
        <option value="6">06</option>
        <option value="7">07</option>
        <option value="8">08</option>
        <option value="9">09</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        <option value="37">37</option>
        <option value="38">38</option>
        <option value="39">39</option>
        <option value="40">40</option>
        <option value="41">41</option>
        <option value="42">42</option>
        <option value="43">43</option>
        <option value="44">44</option>
        <option value="45">45</option>
        <option value="46">46</option>
        <option value="47">47</option>
        <option value="48">48</option>
        <option value="49">49</option>
        <option value="50">50</option>
        <option value="51">51</option>
        <option value="52">52</option>
        <option value="53">53</option>
        <option value="54">54</option>
        <option value="55">55</option>
        <option value="56">56</option>
        <option value="57">57</option>
        <option value="58">58</option>
        <option value="59">59</option>
    </select>

    <select id="second-select">
        <option value="0">00</option>
        <option value="1">01</option>
        <option value="2">02</option>
        <option value="3">03</option>
        <option value="4">04</option>
        <option value="5">05</option>
        <option value="6">06</option>
        <option value="7">07</option>
        <option value="8">08</option>
        <option value="9">09</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        <option value="37">37</option>
        <option value="38">38</option>
        <option value="39">39</option>
        <option value="40">40</option>
        <option value="41">41</option>
        <option value="42">42</option>
        <option value="43">43</option>
        <option value="44">44</option>
        <option value="45">45</option>
        <option value="46">46</option>
        <option value="47">47</option>
        <option value="48">48</option>
        <option value="49">49</option>
        <option value="50">50</option>
        <option value="51">51</option>
        <option value="52">52</option>
        <option value="53">53</option>
        <option value="54">54</option>
        <option value="55">55</option>
        <option value="56">56</option>
        <option value="57">57</option>
        <option value="58">58</option>
        <option value="59">59</option>
    </select>

    <p id="result-wrapper"></p>
    <script>
        // 现在我们要做一个稍微复杂的东西，如下HTML，有一堆Select用于选择日期和时间，在选择后，实时在 id 为 result - wrapper 的 p 标签中显示所选时间和当前时间的差值。
        // 使用上方的HTML结构（可以根据需要自行微调）为基础编写JavaScript代码
        // 当变更任何一个select选择时，更新 result - wrapper 的内容
        // 当所选时间早于现在时间时，文案为 现在距离 "所选时间" 已经过去 xxxx
        // 当所选时间晚于现在时间时，文案为 现在距离 "所选时间" 还有 xxxx
        // 注意当前时间经过所选时间时候的文案变化
        // 注意选择不同月份的时候，日期的可选范围不一样，比如1月可以选31天，11月只有30天，注意闰年
        // 同样，需要注意，通过优雅的函数封装，使得代码更加可读且可维护
        //日期的申明
        var now;
        var year;
        var month;
        var day;
        var date;
        var hour;
        var m;
        var s;
        //选中日期的申明
        var y;
        var m;
        var d;
        var h;
        var min;
        var sec;
        var week;
        //select申明
        var selectyear = document.getElementById('year-select');
        var selectmonth = document.getElementById('month-select');
        var selectday = document.getElementById('day-select');
        var selectdate = document.getElementById('date-select');;
        var selecthour = document.getElementById('hour-select');
        var selectm = document.getElementById('minite-select');
        var selects = document.getElementById('second-select');
        //select的申明
        var select = document.getElementsByTagName('select');
        var result = document.getElementById('result-wrapper');
        var t = setInterval(inputresult, 1000);
        // 初始化日期
        initdate();
        function initdate() {
            getnowtime();
            selectyear.value = year;
            selectmonth.value = month;
            selectday.value = date;
            selecthour.value = hour;
            selectm.value = m;
            selects.value = s;
            changeselect();
        }
        //每一个select都要绑定onchange事件
        for (var i = 0; i < select.length; i++) {
            select[i].onchange = function () {
                clearInterval(t);
                t = setInterval(inputresult, 1000);
            }
        }
        select[1].onchange = function () {
            // 日期选择范围改变
            changeselect();
            
        }
        function changeselect() {
            getselecttime();
            switch (m) {
                case '1':
                case '3':
                case '5':
                case '7':
                case '8':
                case '10':
                case '12':
                    adddayselect(31);
                    break;
                case '4':
                case '6':
                case '7':
                case '9':
                case '11':
                    adddayselect(30);
                    break;
                case '2':
                    isLeapYear();
            }
        }
        function isLeapYear() {
            if (y % 4 == 0 && y % 100 != 0 || y % 400 != 0) {
                adddayselect(29);
            }
            else {
                adddayselect(28);
            }
        }
        function adddayselect(num) {
            var str = '';
            for (var i = 1; i <= num; i++) {
                i = i >= 10 ? i : '0' + i;
                str += '<option value=' + '"' + + i + '"' + '>' + i + '</option>';
            }
            selectday.innerHTML = str;
            console.log(str);
            
        }
        function inputresult() {
            result.innerHTML = getdifference();
        }

        //获select取当前系统时间
        function getnowtime() {
            now = new Date();
            year = now.getFullYear();
            month = now.getMonth() + 1;
            date = now.getDate();
            day = now.getDay();
            hour = now.getHours();
            m = now.getMinutes();
            s = now.getSeconds();

        }

        //获取选中的值
        function getselectvaule(obj) {
            var index = obj.selectedIndex; // 选中索引
            // return  obj.options[index].text; // 选中文本     
            return obj.options[index].value; // 选中值        
        }
        //选中的日期
        function getselecttime() {
            y = getselectvaule(selectyear);
            m = getselectvaule(selectmonth);
            d = getselectvaule(selectday);
            h = getselectvaule(selecthour);
            min = getselectvaule(selectm);
            sec = getselectvaule(selects);
            var old_date = new Date(y + '-' + m + '-' + d + '- ' + h + ':' + min + ':' + sec);
            week = old_date.getDay();
        }
        //拼接选中的日期
        function getselecttimeformat() {
            var weekday = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
            return getselectvaule(selectyear) + "年" + modifydate(getselectvaule(selectmonth)) + "月" + (getselectvaule(selectday)) + "日" + weekday[week] + modifydate(getselectvaule(selecthour)) + "时" + modifydate(getselectvaule(selectm)) + "分" + modifydate(getselectvaule(selects)) + "秒";
        }
        //个位数加0处理
        function modifydate(x) {
            return x >= 10 ? x : '0' + x;
        }
        //获取时间的差值
        function getdifference() {
            getnowtime();
            getselecttime();
            return '现在距离 ' + getselecttimeformat() + formatdifftime();

        }
        //处理时间差值
        function formatdifftime() {
            getnowtime();
            getselecttime();
            var old_date = new Date(y + '-' + m + '-' + d + '- ' + h + ':' + min + ':' + sec);
            var difftime; //计算时间差
            if (now == old_date) {
                return '天涯共此时';
            }
            difftime = (now > old_date) ? (now - old_date) / 1000 : (old_date - now) / 1000
            var days = parseInt(difftime / 86400); // 天  24*60*60*1000 
            var hours = parseInt(difftime / 3600) - 24 * days;    // 小时 60*60 总小时数-过去的小时数=现在的小时数 
            var minutes = parseInt(difftime % 3600 / 60); // 分钟 -(day*24) 以60秒为一整份 取余 剩下秒数 秒数/60 就是分钟数
            var seconds = parseInt(difftime % 60);  // 以60秒为一整份 取余 剩下秒数
            if (now > old_date) {
                return ('已经过去 ' + days + "天, " + hours + "小时, " + minutes + "分钟, " + seconds + "秒");
            }
            else {
                return (' 还要 ' + days + "天 " + hours + "小时  " + minutes + "分钟  " + seconds + "秒");
            }
        }
    </script>
</body>

</html>